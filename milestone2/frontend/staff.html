<!DOCTYPE html>
<html>
<head>
    <title>Staff Notification Panel</title>
    <style>
        body {
            font-family: Arial;
            padding: 2rem;
            max-width: 500px;
            margin: auto;
        }

        h2 {
            margin-top: 2rem;
        }

        input, button {
            margin: 0.5rem 0;
            padding: 0.5rem;
            width: 100%;
        }
    </style>
</head>
<body>

    <h1>MLMS Staff Panel</h1>

    <h2>Login</h2>
    <form id="loginForm">
        <input type="text" id="username" placeholder="Username" required />
        <input type="password" id="password" placeholder="Password" required />
        <button type="submit">Login</button>
    </form>

    <h2>Send Notification</h2>
    <form id="notifyForm">
        <input type="number" id="userId" placeholder="User ID" required />
        <input type="text" id="message" placeholder="Message" required />
        <button type="submit">Send Notification</button>
    </form>

    <p id="output"></p>

    <script>
    let token = "";

    // LOGIN FORM
    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

        const res = await fetch("http://localhost:5062/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username, password })
      });

      const data = await res.json();

      if (data.token) {
        token = data.token;
        document.getElementById("output").innerText = "✅ Logged in successfully.";
      } else {
        document.getElementById("output").innerText = "❌ Login failed.";
      }
    });

    // NOTIFICATION FORM
    document.getElementById("notifyForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!token) {
        document.getElementById("output").innerText = "❌ Please login first.";
        return;
      }

      const userId = document.getElementById("userId").value;
      const message = document.getElementById("message").value;

        const res = await fetch("http://localhost:5062/api/notification/send", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ userId, message })
      });

      if (res.ok) {
        const data = await res.json();
        document.getElementById("output").innerText = `✅ ${data.message}`;
      } else {
        document.getElementById("output").innerText = "❌ Failed to send notification.";
      }
    });
    </script>

</body>
</html>
